<%= render :partial => 'componentsidebar' %>

<div class="container">
<h1><%= @name %></h1>




</div>





















<ol>
<% @tasks.each do |task| %>
<li><%= link_to task.name, task %>
  <% unless task.document.url == "/documents/original/missing.png" %>
  <%= link_to "View Attachment" ,task.document.url, :target => "_blank" %>
  <% end %>







 <br>
 <%= task.check_status %>
<% if task.deadline == nil %>
                <%= "No Deadline" %>
              <% else %>
              <%= task.deadline.strftime("%b %d, %Y") %>
              <% end %>
 
 <%= form_for task, :method => 'put', 
  :html => { :multipart => true } do |form| %>
<%= form.hidden_field :task_id, :value => task.id %>
<%= form.hidden_field :document, :value => "delete_attachment" %>
<%= form.submit "Delete Attachment" %>
<% end %>

  

<% if task.status == "Complete" %>
    <%= form_for task, :method => 'put' do |form| %>
      <%= form.hidden_field :status, :value => "Incomplete" %>
      <%= form.submit "Mark As Incomplete"%>
    <% end %>
  <% else %>
    <%= form_for task, :method => 'put' do |form| %>
        <%= form.hidden_field :status, :value => "Complete" %>
        <%= form.submit "Mark As Complete"%>
      <% end %>

  <% end %>

<%= form_for task, :method => 'put', 
  :html => { :multipart => true } do |form| %>
  <%= form.file_field :document %>
  <%= form.submit "Add Attachment" %>
<% end %>

<% task.users.each do |user| %>
<%= user.email %>
<% end %>

<% available_users_task = @available_users - task.users %>

<ol> <% available_users_task.each do |user|%>
<li> <%= user.email %> 
      <%= form_for task, :method => "PUT" do |f| %>
      <%= f.hidden_field :user_id, :value => user.id %>
      <%= f.submit "Add" %>
      <% end %>
      <% end %>
</li>

<%= link_to "Delete", task, :method => :delete %>

</li>
<% end %>
</ol>


<%= form_for @task, :html => { :multipart => true } do |f|%>
<%= f.label :name %>
<%= f.text_field :name %>
<%= f.label :description %>
<%= f.text_area :description %>
<%= f.label :deadline %>
<%= f.date_field :deadline %>
<%= f.label :avatar %>
<%= f.file_field :avatar %>
<%= f.hidden_field :component_id, :value => @component.id %>

<%= f.submit "Create Task" %>
<% end %>

<h3>Users in Component</h3>
<% @component.users.each do |user|%>
<%= user.email %>
<% end %>

<h3> Add User to Component </h3>

<% available_users_component = @available_users - @component.users %>

<ol> <% available_users_component.each do |user|%>
<li> <%= user.email %> 
      <%= form_for @component, :method => "PUT" do |f| %>
      <%= f.hidden_field :user_id, :value => user.id %>
      <%= f.submit "Add" %>
      <% end %>
</li>
<% end %>

</ol>
<%= link_to "Home", root_path  %>
<%= link_to "Back to Project Page", @component.project %>